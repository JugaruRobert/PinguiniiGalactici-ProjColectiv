<div class="table-container">
  <table mat-table [dataSource]="dataSource" matSort class="attendaces-component mat-elevation-z8 ">
   
    <!-- Position Column -->
    <ng-container matColumnDef="position">
      <th mat-header-cell *matHeaderCellDef> No. </th>
      <td mat-cell *matCellDef="let pos = index"> {{pos+1}} </td>
    </ng-container>
  
    <!-- Course Column -->
    <ng-container matColumnDef="course">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Course </th>
      <td mat-cell *matCellDef="let element"> 
       {{element.CourseName}}
      </td>
    </ng-container>

    <!-- Year Column -->
    <ng-container matColumnDef="year">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Year </th>
        <td readonly mat-cell *matCellDef="let element"> 
          {{element.Year}} 
        </td>
      </ng-container>
  
     <!-- Weeks Columns from 1 to 14 -->
    <div *ngFor="let i of [1,2,3,4,5,6,7,8,9,10,11,12,13,14]">
        <ng-container matColumnDef="week{{i}}">
            <th mat-header-cell *matHeaderCellDef> Week {{i}} </th>
            <td mat-cell *matCellDef="let element">
              {{element.LabGrades[i-1]}} 
            </td>
            <td></td>
          </ng-container>
    </div>
  
    <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns; let index = index"></tr>
  </table> 
  
  
  </div>